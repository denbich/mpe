let combination_count=+$('[name="combination_count"]').val(),old_combination_count,current_delete_combination,next_combination,temp,i=0;function delete_combination(n){if(combination_count>=1)for(old_combination_count=combination_count,combination_count-=1,current_delete_combination=$(n).attr("data-id"),$("#combination"+current_delete_combination).remove(),$("#combination_count").html(combination_count),$('[name="combination_count"]').val(combination_count),i=next_combination=+current_delete_combination+1;i<=old_combination_count;i++)temp=+i-1,$("#combination"+i).attr("data-id",temp),$("#combination"+i).attr("id","combination"+temp),$("#divcombination"+i).attr("data-id",temp),$("#divcombination"+i).attr("id","divcombination"+temp),$("#div-combination"+i).attr("id","div-combination"+temp),$("#delete_button"+i).attr("data-id",temp),$("#delete_button"+i).attr("id","delete_button"+temp),$('[for="name_combination'+i+'"]').html("Kombinacja nr "+temp+":"),$('[for="name_combination'+i+'"]').attr("for","name_combination"+temp),$("#name_combination"+i).attr("data-id",temp),$("#name_combination"+i).attr("name","name_combination"+temp),$("#name_combination"+i).attr("id","name_combination"+temp),$('[for="quantity_combination'+i+'"]').html("Ilość"),$('[for="quantity_combination'+i+'"]').attr("for","quantity_combination"+temp),$("#quantity_combination"+i).attr("data-id",temp),$("#quantity_combination"+i).attr("name","quantity_combination"+temp),$("#quantity_combination"+i).attr("id","quantity_combination"+temp)}$("#add_combination").click(function(){combination_count+=1,$('[name="combination_count"]').val(combination_count);let n="<div id='combination"+combination_count+"' data-id='"+combination_count+"'><div id='divcombination"+combination_count+"'><div class='w-100 text-right' id='buttoncombination"+combination_count+"'> <button class='btn btn-icon btn-danger btn-sm text-right delete_combination' id='delete_button"+combination_count+"' data-id='"+combination_count+"' type='button' onclick='delete_combination(this)'> <span class='btn-inner--icon'><i class='fas fa-trash-alt'></i></span> </button></div></div>  <div class='pb-0' id='div-combination"+combination_count+"'><label for='name_combination"+combination_count+"' class='mt-1'>Kombinacja nr "+combination_count+":</label><input type='text' class='form-control' maxlength='255' data-id='"+combination_count+"' id='name_combination"+combination_count+"' name='name_combination"+combination_count+"' required><label for='quantity_combination"+combination_count+"' class='mt-1'>Ilość:</label><input type='number' name='quantity_combination"+combination_count+"' class='form-control' data-id='"+combination_count+"' id='quantity_combination"+combination_count+"'></div> <hr class='w-100 text-center ml-0' style='color: #707070'></div>";$("#combination_count").html(combination_count),$("#combinations").append(n)}),$(document).ready(function(){$('input[type="radio"][name="type"]').on("change",function(){"virtual"==this.value?($("#quantity-div").addClass("d-none"),$("#combination-check").prop("disabled",!0),$("#type-multistep-content").removeClass("d-none"),$("#type-multistep-alert").addClass("d-none")):"physical"==this.value&&($("#quantity-div").removeClass("d-none"),$("#combination-check").prop("disabled",!1),$("#type-multistep-content").addClass("d-none"),$("#type-multistep-alert").removeClass("d-none"))}),$('input[type="radio"][name="codetype"]').on("change",function(){"virtual"==$('input[type="radio"][name="type"]:checked').val()&&("manual"==$('input[type="radio"][name="codetype"]:checked').val()?($("#codemanualinputdiv").removeClass("d-none"),$("#codeautodiv").addClass("d-none")):"auto"==$('input[type="radio"][name="codetype"]:checked').val()&&($("#codemanualinputdiv").addClass("d-none"),$("#codeautodiv").removeClass("d-none")))}),$("#combination-check").on("click",function(){(isChecked=$(this).is(":checked"))?($("#combination-nav-item").removeClass("d-none"),$("#quantity-div").addClass("d-none"),$("#combination-multistep-content").removeClass("d-none"),$("#combination-multistep-alert").addClass("d-none")):($("#combination-nav-item").addClass("d-none"),$("#quantity-div").removeClass("d-none"),$("#combination-multistep-content").addClass("d-none"),$("#combination-multistep-alert").removeClass("d-none"))})});let category_dropdown=new Choices(document.getElementById("category-dropdown"),{searchEnabled:!1,shouldSort:!1,placeholder:!0}),sponsor_dropdown=new Choices(document.getElementById("sponsor-dropdown"),{searchEnabled:!1,shouldSort:!1,placeholder:!0}),codevalues=new Choices(document.getElementById("codevalues"),{allowHTML:!0,delimiter:",",editItems:!0,removeItemButton:!0});$("#create-button-category").on("click",function(){$("#modalcategory").modal("hide");let n=$("input[name=category-name]"),t=$("input[name=category-description]");$.ajax({url:createcategory,type:"POST",data:{title:n.val(),content:t.val()},success:function(o){let e=o.volid,a=o.title;o&&(Swal.fire({icon:suc,title:categorysuc,showConfirmButton:!1,timer:3e3}),n.val(""),t.val(""),category_dropdown.setChoices([{value:e,label:a,selected:!0},],"value","label",!1))},error:function(n){422==n.status?Swal.fire({icon:"error",title:err,text:gapserr,showConfirmButton:!1,timer:4e3}):(Swal.fire({icon:"error",title:err,text:categoryerr,showConfirmButton:!1,timer:3e3}),name.val(""),description.val(""))}})}),$("#create-button-sponsor").on("click",function(){$("#modalsponsor").modal("hide");let n=$("input[name=sponsor_name]").val(),t=$("input[name=sponsor_description]").val(),o=$("input[name=sponsor_address]").val(),e=$("input[name=sponsor_telephone]").val(),a=$("input[name=sponsor_website]").val(),c=$("input[name=sponsor_email]").val(),m=$("input[name=sponsor_facebook]").val(),d=$("input[name=sponsor_instagram]").val(),r=$("input[name=logo_photo]").val(),l=$('meta[name="csrf-token"]').attr("content");$.ajax({url:createsponsor,type:"POST",data:{name:n,description:t,address:o,telephone:e,website:a,email:c,facebook:m,instagram:d,logo:r,_token:l},success:function(n){if(console.log(n),n){let t=n.volid,o=n.name;Swal.fire({icon:suc,title:sponsorsuc,showConfirmButton:!1,timer:3e3}),$("input[name=sponsor_name]").val(""),$("input[name=sponsor_description]").val(""),$("input[name=sponsor_address]").val(""),$("input[name=sponsor_telephone]").val(""),$("input[name=sponsor_website]").val(""),$("input[name=sponsor_email]").val(""),$("input[name=sponsor_facebook]").val(""),$("input[name=sponsor_instagram]").val(""),sponsor_dropdown.setChoices([{value:t,label:o,selected:!0},],"value","label",!1)}},error:function(n){console.log(n),422==n.status?Swal.fire({icon:"error",title:err,text:gapserr,showConfirmButton:!1,timer:4e3}):Swal.fire({icon:"error",title:err,text:sponsorerr,showConfirmButton:!1,timer:3e3})}})}),$("#create_prize_form").submit(function(){$("#create_prize_button").prop("disabled",!0),$("#create_prize_button").prepend('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> ')});
